# Render Blueprint
# Deploy with: https://render.com/docs/blueprint-spec
#
# This deploys News Bench as a web service with:
# - Automatic 12-hour news pipeline updates
# - Gunicorn for production performance
#
# Note: Free tier doesn't persist data between deploys.
# The scheduler rebuilds the database automatically.

services:
  - type: web
    name: news-bench
    runtime: python
    plan: free

    # Build settings - also run initial pipeline to populate data
    buildCommand: pip install -r requirements.txt && python run.py

    # Start command (gunicorn for production)
    startCommand: gunicorn app:app --bind 0.0.0.0:$PORT --workers 2 --threads 4 --timeout 120

    # Environment variables
    envVars:
      - key: ENABLE_SCHEDULER
        value: "true"
      - key: GROQ_API_KEY
        sync: false  # Set manually in dashboard for security
      - key: PYTHONUNBUFFERED
        value: "1"

    # Health check
    healthCheckPath: /api/health

    # Auto-deploy on push
    autoDeploy: true
